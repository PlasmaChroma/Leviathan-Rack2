# MATHS Emulation Specification and Requirements

## 1. Introduction

This document outlines the specifications and requirements for a software emulation of the Make Noise MATHS Eurorack module, based on the 2013 version of the hardware and its official manual.

The MATHS is a versatile analog computer designed for musical purposes. At its core, it is a dual voltage-controlled function generator, but it can be used for a wide range of applications, including:

*   Envelope generation (AD, ASR)
*   Low-frequency oscillation (LFO)
*   Slew limiting (portamento)
*   Voltage mixing and scaling
*   Logic operations (AND, OR)
*   And much more.

## 2. Functional Requirements

### 2.1. Channels 1 & 4

Channels 1 and 4 are the primary function generators in the MATHS module. They are nearly identical, with the only difference being the "End of" outputs (EOR for Ch. 1, EOC for Ch. 4).

#### 2.1.1. Controls

*   **Rise Control:**
    *   Sets the time it takes for the voltage to rise.
    *   Range: From very fast (audio rate, ~1kHz) to very slow (~25 minutes).
    *   Clockwise rotation increases the rise time.
*   **Fall Control:**
    *   Sets the time it takes for the voltage to fall.
    *   Range: From very fast (audio rate, ~1kHz) to very slow (~25 minutes).
    *   Clockwise rotation increases the fall time.
*   **Vari-Response Control:**
    *   Continuously adjusts the response curve of the function from logarithmic, through linear (at the 12 o'clock position), to exponential.
*   **Cycle Button:**
    *   Toggles the self-cycling (LFO) mode.
    *   When ON, the channel will continuously cycle, creating an LFO.
    *   When OFF, the channel will only fire when triggered.
*   **Cycle LED:**
    *   Indicates the state of the Cycle Button (ON/OFF).

#### 2.1.2. Inputs

*   **Signal Input:**
    *   Direct-coupled input.
    *   Range: +/-10V.
    *   Used for slew limiting (portamento) and generating ASR envelopes.
    *   When a signal is present, the channel will try to follow it, with the Rise and Fall controls limiting the rate of change.
*   **Trigger Input:**
    *   Triggers the function generator, regardless of the Signal Input.
    *   A rising edge (Gate or Pulse) will start the Rise phase.
    *   The function will rise from 0V to 10V and then immediately fall back to 0V.
    *   The module can be re-triggered during the falling phase, but not the rising phase.
*   **Rise CV Input:**
    *   Linear control voltage input for the Rise parameter.
    *   Range: +/-8V.
    *   Positive voltage increases rise time.
    *   Negative voltage decreases rise time.
*   **Fall CV Input:**
    *   Linear control voltage input for the Fall parameter.
    *   Range: +/-8V.
    *   Positive voltage increases fall time.
    *   Negative voltage decreases fall time.
*   **Both CV Input:**
    *   Bi-polar, exponential control voltage input for the entire function's duration (both Rise and Fall).
    *   Range: +/-8V.
    *   Positive voltage decreases the total time.
    *   Negative voltage increases the total time.
*   **Cycle Input:**
    *   Voltage-controlled switching of the Cycle mode.
    *   Requires a minimum of +2.5V for HIGH.
    *   Gate HIGH: Cycles ON.
    *   Gate LOW: Cycles OFF (unless the Cycle button is engaged).

#### 2.1.3. Outputs

*   **Unity Signal Output:**
    *   Un-attenuated output of the channel's function.
    *   0-8V when cycling.
    *   When not cycling, it follows the amplitude of the input signal.
*   **End of Rise (EOR) Output (Channel 1 only):**
    *   A pulse (0V to 10V) that goes HIGH at the end of the Rise portion of the function.
    *   EOR LED indicates the state.
*   **End of Cycle (EOC) Output (Channel 4 only):**
    *   A pulse (0V to 10V) that goes HIGH at the end of the Fall portion of the function (i.e., at the end of the cycle).
    *   EOC LED indicates the state.
*   **Unity LED:**
    *   Indicates the voltage at the Unity Signal Output.
    *   Green for positive voltages, Red for negative voltages.
    *   Brightness corresponds to the absolute voltage level.

### 2.2. Channels 2 & 3

Channels 2 and 3 are utility channels for scaling, inverting, and offsetting signals.

#### 2.2.1. Controls

*   **CH. 2/3 Attenuverter Control:**
    *   Provides for scaling, attenuation, and inversion of the signal patched to the corresponding Signal Input.
    *   With no signal present, it controls the level of the offset generated by the channel.

#### 2.2.2. Inputs

*   **Direct Coupled Channel 2 Signal Input:**
    *   Normalized to a +10V reference for generation of voltage offsets.
    *   Input Range: +/-10Vpp.
*   **Direct Coupled Channel 3 Signal Input:**
    *   Normalized to a +5V reference for generation of voltage offsets.
    *   Input Range: +/-10Vpp.

### 2.3. Mixing Bus (SUM, OR, INV)

The four channels are normalled to a mixing bus, which provides SUM, OR, and Inverted SUM outputs.

#### 2.3.1. Outputs

*   **CH. 1-4 Variable Outputs:**
    *   The processed signal from each of the four channels.
    *   The level is controlled by the corresponding attenuverter.
    *   Output Range: +/-10V.
    *   These outputs are normalled to the SUM and OR busses. Inserting a patch cable into a variable output removes that channel's signal from the bus.
*   **OR Bus Output:**
    *   The result of an analog logic OR (highest voltage) of the four channels.
    *   Range: 0V to 10V.
*   **SUM Bus Output:**
    *   The sum of the voltages of the four channels.
    *   Range: +/-10V.
*   **Inverted SUM Output:**
    *   The inverted version of the SUM Bus Output.
    *   Range: +/-10V.
*   **SUM Bus LEDs:**
    *   Indicate the voltage on the SUM bus.
    *   Green for positive voltages, Red for negative voltages.

## 3. Non-Functional Requirements

### 3.1. Performance

*   The software emulation should be optimized for real-time audio processing.
*   CPU usage should be minimized to allow for multiple instances to run concurrently in a typical DAW project.
*   The emulation should not introduce any significant latency beyond what is inherent in the host DAW's buffer settings.

### 3.2. User Interface (UI)

*   The UI should be a visually accurate and scalable representation of the MATHS hardware module.
*   All controls (knobs, buttons, switches) should be interactive and provide clear visual feedback.
*   LEDs should accurately reflect the state of the internal signals, including brightness variations.
*   Tooltips should be available for all controls and I/O jacks to explain their function.

### 3.3. Platform

*   The emulation should be developed as a cross-platform audio plugin.
*   Supported formats should include VST3, and AU.
*   The plugin should be available for both Windows and macOS.

## 4. Interface Requirements (I/O Summary)

### 4.1. Inputs

*   **Channel 1:**
    *   Signal In (+/-10V)
    *   Trigger In
    *   Rise CV In (+/-8V)
    *   Fall CV In (+/-8V)
    *   Both CV In (+/-8V)
    *   Cycle In
*   **Channel 2:**
    *   Signal In (+/-10Vpp, normalled to +10V)
*   **Channel 3:**
    *   Signal In (+/-10Vpp, normalled to +5V)
*   **Channel 4:**
    *   Signal In (+/-10V)
    *   Trigger In
    *   Rise CV In (+/-8V)
    *   Fall CV In (+/-8V)
    *   Both CV In (+/-8V)
    *   Cycle In

### 4.2. Outputs

*   **Channel 1:**
    *   Variable Out (+/-10V)
    *   Unity Out (0-8V cycling)
    *   End of Rise (EOR) Out (0V or 10V)
*   **Channel 2:**
    *   Variable Out (+/-10V)
*   **Channel 3:**
    *   Variable Out (+/-10V)
*   **Channel 4:**
    *   Variable Out (+/-10V)
    *   Unity Out (0-8V cycling)
    *   End of Cycle (EOC) Out (0V or 10V)
*   **Mix Bus:**
    *   SUM Out (+/-10V)
    *   INV Out (+/-10V)
    *   OR Out (0-10V)

